2026/01/07 11:23:14 üìÅ Loaded .env from ../../../../.env for tests
=== RUN   TestFlowExecutor_PasswordHashing
2026/01/07 11:23:14 ‚úÖ FlowExecutor: Registered handlers for 3 supported events
=== RUN   TestFlowExecutor_PasswordHashing/Should_hash_password_on_beforeCreate
2026/01/07 11:23:14 üîç FlowExecutor: checking 1 flows for trigger 'beforeCreate' on object '_System_User'
2026/01/07 11:23:14 üîÑ Flow Test_Password_Hash: executing UpdateRecord action on _System_User
2026/01/07 11:23:14 ‚úÖ Flow Test_Password_Hash: executed successfully
2026/01/07 11:23:14 Verified: SecurePass123! -> $2a$10$fGrHJ0oYt0eePQZgJI70iOMnjVsP/JLOUHcOrcm/6m68VHNR2pSlC
--- PASS: TestFlowExecutor_PasswordHashing (0.10s)
    --- PASS: TestFlowExecutor_PasswordHashing/Should_hash_password_on_beforeCreate (0.10s)
=== RUN   TestFlowExecutor_HighPriorityAlert
2026/01/07 11:23:14 ‚úÖ FlowExecutor: Registered handlers for 3 supported events
=== RUN   TestFlowExecutor_HighPriorityAlert/Should_Trigger_Alert_on_High_Priority
2026/01/07 11:23:14 üîç FlowExecutor: checking 1 flows for trigger 'afterCreate' on object 'Ticket'
2026/01/07 11:23:14 üîÑ Flow High Priority Alert: executing CreateRecord action on Ticket
2026/01/07 11:23:14 ‚úÖ Flow High Priority Alert: executed successfully
=== RUN   TestFlowExecutor_HighPriorityAlert/Should_NOT_Trigger_Alert_on_Low_Priority
2026/01/07 11:23:14 üîç FlowExecutor: checking 1 flows for trigger 'afterCreate' on object 'Ticket'
--- PASS: TestFlowExecutor_HighPriorityAlert (0.00s)
    --- PASS: TestFlowExecutor_HighPriorityAlert/Should_Trigger_Alert_on_High_Priority (0.00s)
    --- PASS: TestFlowExecutor_HighPriorityAlert/Should_NOT_Trigger_Alert_on_Low_Priority (0.00s)
=== RUN   TestMasterDetail_CascadeDelete
2026/01/07 11:23:14 üìê Creating table: project_1767756194496314000
2026/01/07 11:23:14 üìù Executing DDL for project_1767756194496314000
2026/01/07 11:23:14 ‚ùå Failed to create table project_1767756194496314000: Error 1067 (42000): Invalid default value for 'created_date'
    master_detail_test.go:68: 
        	Error Trace:	/Users/qiliu/projects/nexuscrm/backend/internal/application/services/master_detail_test.go:68
        	Error:      	Received unexpected error:
        	            	failed to create table project_1767756194496314000: Error 1067 (42000): Invalid default value for 'created_date'
        	Test:       	TestMasterDetail_CascadeDelete
--- FAIL: TestMasterDetail_CascadeDelete (0.00s)
=== RUN   TestMetadataService_Apps_IsDefault
=== RUN   TestMetadataService_Apps_IsDefault/Create_App_With_Default
=== RUN   TestMetadataService_Apps_IsDefault/Update_App_To_Default
--- PASS: TestMetadataService_Apps_IsDefault (0.01s)
    --- PASS: TestMetadataService_Apps_IsDefault/Create_App_With_Default (0.00s)
    --- PASS: TestMetadataService_Apps_IsDefault/Update_App_To_Default (0.00s)
=== RUN   TestMetadataService_Objects_ThemeColor_Integration
2026/01/07 11:23:14 üìê Creating table: color_test_1767756194503460000
2026/01/07 11:23:14 üìù Executing DDL for color_test_1767756194503460000
2026/01/07 11:23:14 ‚úÖ DDL executed successfully for color_test_1767756194503460000
2026/01/07 11:23:14    ‚úÖ Table created and registered (strict): color_test_1767756194503460000
2026/01/07 11:23:14 üóëÔ∏è Metadata cache invalidated
2026/01/07 11:23:14 üî• Dropping table: color_test_1767756194503460000
2026/01/07 11:23:14    ‚úÖ Table dropped and metadata cleaned: color_test_1767756194503460000
--- PASS: TestMetadataService_Objects_ThemeColor_Integration (0.13s)
=== RUN   TestMetadataService_Themes_Integration
2026/01/07 11:23:14 ‚úÖ Theme activated: dc609f76-8d36-4a83-a485-11032dec175a
--- PASS: TestMetadataService_Themes_Integration (0.01s)
=== RUN   TestCheckObjectPermissionWithUser_NilUser
--- PASS: TestCheckObjectPermissionWithUser_NilUser (0.00s)
=== RUN   TestCheckObjectPermissionWithUser_SuperUser
--- PASS: TestCheckObjectPermissionWithUser_SuperUser (0.00s)
=== RUN   TestCheckFieldEditabilityWithUser_SystemField
--- PASS: TestCheckFieldEditabilityWithUser_SystemField (0.00s)
=== RUN   TestCheckFieldVisibilityWithUser_NilUser
--- PASS: TestCheckFieldVisibilityWithUser_NilUser (0.00s)
=== RUN   TestCheckFieldVisibilityWithUser_SuperUser
--- PASS: TestCheckFieldVisibilityWithUser_SuperUser (0.00s)
=== RUN   TestCheckPermissionOrErrorWithUser_NilUser
--- PASS: TestCheckPermissionOrErrorWithUser_NilUser (0.00s)
=== RUN   TestCheckPermissionOrErrorWithUser_SuperUser
--- PASS: TestCheckPermissionOrErrorWithUser_SuperUser (0.00s)
=== RUN   TestGetEffectiveSchema_NilSchema
--- PASS: TestGetEffectiveSchema_NilSchema (0.00s)
=== RUN   TestGetEffectiveSchema_SuperUser
--- PASS: TestGetEffectiveSchema_SuperUser (0.00s)
=== RUN   TestGetEffectiveSchema_NilUser
--- PASS: TestGetEffectiveSchema_NilUser (0.00s)
=== RUN   TestCheckRecordAccess_Owner
--- PASS: TestCheckRecordAccess_Owner (0.00s)
=== RUN   TestCheckRecordAccess_NonOwner
--- PASS: TestCheckRecordAccess_NonOwner (0.00s)
=== RUN   TestCheckRecordAccess_SuperUser
--- PASS: TestCheckRecordAccess_SuperUser (0.00s)
=== RUN   TestCheckRecordAccess_NoOwnerField
--- PASS: TestCheckRecordAccess_NoOwnerField (0.00s)
=== RUN   TestCheckRecordAccess_PointerOwner
--- PASS: TestCheckRecordAccess_PointerOwner (0.00s)
=== RUN   TestRollupSummary_Sum
2026/01/07 11:23:14 üìê Creating table: invoice_1767756194637681000
2026/01/07 11:23:14 üìù Executing DDL for invoice_1767756194637681000
2026/01/07 11:23:14 ‚ùå Failed to create table invoice_1767756194637681000: Error 1067 (42000): Invalid default value for 'created_date'
    rollup_test.go:63: 
        	Error Trace:	/Users/qiliu/projects/nexuscrm/backend/internal/application/services/rollup_test.go:63
        	Error:      	Received unexpected error:
        	            	failed to create table invoice_1767756194637681000: Error 1067 (42000): Invalid default value for 'created_date'
        	Test:       	TestRollupSummary_Sum
--- FAIL: TestRollupSummary_Sum (0.00s)
=== RUN   TestSchemaManager_Integration_ACID
    schema_manager_integration_test.go:57: Creating table test_acid_obj_1767756194638172000...
2026/01/07 11:23:14 üìê Creating table: test_acid_obj_1767756194638172000
2026/01/07 11:23:14 üìù Executing DDL for test_acid_obj_1767756194638172000
2026/01/07 11:23:14 ‚úÖ DDL executed successfully for test_acid_obj_1767756194638172000
2026/01/07 11:23:14    ‚úÖ Table created and registered (strict): test_acid_obj_1767756194638172000
    schema_manager_integration_test.go:111: ‚úÖ Integration Test Passed: Table and Metadata created correctly.
2026/01/07 11:23:14 üî• Dropping table: test_acid_obj_1767756194638172000
2026/01/07 11:23:14    ‚úÖ Table dropped and metadata cleaned: test_acid_obj_1767756194638172000
--- PASS: TestSchemaManager_Integration_ACID (0.12s)
=== RUN   TestValidationService_ValidateRecord
=== RUN   TestValidationService_ValidateRecord/Valid_Record
=== RUN   TestValidationService_ValidateRecord/Missing_Required
=== RUN   TestValidationService_ValidateRecord/Too_Young
=== RUN   TestValidationService_ValidateRecord/Invalid_Regex
=== RUN   TestValidationService_ValidateRecord/Validation_Rule_Failure
--- PASS: TestValidationService_ValidateRecord (0.00s)
    --- PASS: TestValidationService_ValidateRecord/Valid_Record (0.00s)
    --- PASS: TestValidationService_ValidateRecord/Missing_Required (0.00s)
    --- PASS: TestValidationService_ValidateRecord/Too_Young (0.00s)
    --- PASS: TestValidationService_ValidateRecord/Invalid_Regex (0.00s)
    --- PASS: TestValidationService_ValidateRecord/Validation_Rule_Failure (0.00s)
=== RUN   TestValidationService_NullKeyword
=== RUN   TestValidationService_NullKeyword/Null_keyword_works_with_nil_value
=== RUN   TestValidationService_NullKeyword/Null_keyword_works_with_present_value
=== RUN   TestValidationService_NullKeyword/Not_null_check_works
--- PASS: TestValidationService_NullKeyword (0.00s)
    --- PASS: TestValidationService_NullKeyword/Null_keyword_works_with_nil_value (0.00s)
    --- PASS: TestValidationService_NullKeyword/Null_keyword_works_with_present_value (0.00s)
    --- PASS: TestValidationService_NullKeyword/Not_null_check_works (0.00s)
=== RUN   TestValidationService_EmptyStringNormalization
=== RUN   TestValidationService_EmptyStringNormalization/Empty_date_string_treated_as_null
=== RUN   TestValidationService_EmptyStringNormalization/Empty_number_string_treated_as_null
=== RUN   TestValidationService_EmptyStringNormalization/Empty_text_string_NOT_treated_as_null_(preserved)
--- PASS: TestValidationService_EmptyStringNormalization (0.00s)
    --- PASS: TestValidationService_EmptyStringNormalization/Empty_date_string_treated_as_null (0.00s)
    --- PASS: TestValidationService_EmptyStringNormalization/Empty_number_string_treated_as_null (0.00s)
    --- PASS: TestValidationService_EmptyStringNormalization/Empty_text_string_NOT_treated_as_null_(preserved) (0.00s)
=== RUN   TestValidationService_FailClosed
=== RUN   TestValidationService_FailClosed/Syntax_error_causes_internal_error
=== RUN   TestValidationService_FailClosed/Inactive_rules_are_skipped_even_with_bad_syntax
=== RUN   TestValidationService_FailClosed/Valid_rule_that_passes
=== RUN   TestValidationService_FailClosed/Valid_rule_that_triggers
--- PASS: TestValidationService_FailClosed (0.00s)
    --- PASS: TestValidationService_FailClosed/Syntax_error_causes_internal_error (0.00s)
    --- PASS: TestValidationService_FailClosed/Inactive_rules_are_skipped_even_with_bad_syntax (0.00s)
    --- PASS: TestValidationService_FailClosed/Valid_rule_that_passes (0.00s)
    --- PASS: TestValidationService_FailClosed/Valid_rule_that_triggers (0.00s)
=== RUN   TestValidationService_ValidateFlow
=== RUN   TestValidationService_ValidateFlow/Allow_different_trigger_type
=== RUN   TestValidationService_ValidateFlow/Allow_different_object
=== RUN   TestValidationService_ValidateFlow/Deny_duplicate_trigger
=== RUN   TestValidationService_ValidateFlow/Allow_self_update
=== RUN   TestValidationService_ValidateFlow/Allow_duplicate_if_inactive
--- PASS: TestValidationService_ValidateFlow (0.00s)
    --- PASS: TestValidationService_ValidateFlow/Allow_different_trigger_type (0.00s)
    --- PASS: TestValidationService_ValidateFlow/Allow_different_object (0.00s)
    --- PASS: TestValidationService_ValidateFlow/Deny_duplicate_trigger (0.00s)
    --- PASS: TestValidationService_ValidateFlow/Allow_self_update (0.00s)
    --- PASS: TestValidationService_ValidateFlow/Allow_duplicate_if_inactive (0.00s)
=== RUN   TestValidationService_Naming
=== RUN   TestValidationService_Naming/Object_Valid
=== RUN   TestValidationService_Naming/Field_Valid
=== RUN   TestValidationService_Naming/Object_CamelCase
=== RUN   TestValidationService_Naming/Field_CamelCase
=== RUN   TestValidationService_Naming/Object_Spaces
=== RUN   TestValidationService_Naming/Field_Spaces
=== RUN   TestValidationService_Naming/Object_Dashes
=== RUN   TestValidationService_Naming/Field_Dashes
=== RUN   TestValidationService_Naming/Object_StartNum
=== RUN   TestValidationService_Naming/Field_StartNum
--- PASS: TestValidationService_Naming (0.00s)
    --- PASS: TestValidationService_Naming/Object_Valid (0.00s)
    --- PASS: TestValidationService_Naming/Field_Valid (0.00s)
    --- PASS: TestValidationService_Naming/Object_CamelCase (0.00s)
    --- PASS: TestValidationService_Naming/Field_CamelCase (0.00s)
    --- PASS: TestValidationService_Naming/Object_Spaces (0.00s)
    --- PASS: TestValidationService_Naming/Field_Spaces (0.00s)
    --- PASS: TestValidationService_Naming/Object_Dashes (0.00s)
    --- PASS: TestValidationService_Naming/Field_Dashes (0.00s)
    --- PASS: TestValidationService_Naming/Object_StartNum (0.00s)
    --- PASS: TestValidationService_Naming/Field_StartNum (0.00s)
=== RUN   TestFormulaFields_Integration
2026/01/07 11:23:14 üìê Creating table: product_1767756194758636000
2026/01/07 11:23:14 üìù Executing DDL for product_1767756194758636000
2026/01/07 11:23:14 ‚úÖ DDL executed successfully for product_1767756194758636000
2026/01/07 11:23:14    ‚úÖ Table created and registered (strict): product_1767756194758636000
2026/01/07 11:23:14 ‚úÖ Auto-created default layout for product_1767756194758636000
2026/01/07 11:23:14 üóëÔ∏è Metadata cache invalidated
2026/01/07 11:23:14 ‚ûï Adding column price to table product_1767756194758636000
2026/01/07 11:23:14    üèÅ Executing DDL: ALTER TABLE `product_1767756194758636000` ADD COLUMN `price` VARCHAR(255)
2026/01/07 11:23:14    ‚úÖ DDL execution complete
2026/01/07 11:23:14    ‚úÖ Column added/registered: product_1767756194758636000.price
2026/01/07 11:23:14 üóëÔ∏è Metadata cache invalidated
2026/01/07 11:23:14 ‚ûï Adding column quantity to table product_1767756194758636000
2026/01/07 11:23:14    üèÅ Executing DDL: ALTER TABLE `product_1767756194758636000` ADD COLUMN `quantity` VARCHAR(255)
2026/01/07 11:23:15    ‚úÖ DDL execution complete
2026/01/07 11:23:15    ‚úÖ Column added/registered: product_1767756194758636000.quantity
2026/01/07 11:23:15 üóëÔ∏è Metadata cache invalidated
2026/01/07 11:23:15 ‚ûï Adding column total to table product_1767756194758636000
2026/01/07 11:23:15    üèÅ Executing DDL: ALTER TABLE `product_1767756194758636000` ADD COLUMN `total` DECIMAL(18,6) GENERATED ALWAYS AS (price * quantity) VIRTUAL
2026/01/07 11:23:15    ‚úÖ DDL execution complete
2026/01/07 11:23:15    ‚úÖ Column added/registered: product_1767756194758636000.total
2026/01/07 11:23:15 üóëÔ∏è Metadata cache invalidated
2026/01/07 11:23:15 üîÑ Refreshing metadata cache...
2026/01/07 11:23:15 ‚úÖ Metadata cache refreshed: 74 objects loaded
2026/01/07 11:23:15 ‚ú® Created record 3537ee66-4164-40b3-9577-0cc42cdca93a in product_1767756194758636000 (User: admin-user)
=== RUN   TestFormulaFields_Integration/Read-Time_Calculation
=== RUN   TestFormulaFields_Integration/Filter_by_Formula_(Match)
=== RUN   TestFormulaFields_Integration/Filter_by_Formula_(No_Match)
=== RUN   TestFormulaFields_Integration/Verify_Generated_Column_Schema
    formula_integration_test.go:180: ‚úÖ Generated column expression: `price` * `quantity`
=== RUN   TestFormulaFields_Integration/Update_Propagation
2026/01/07 11:23:15 üìù Updated record 3537ee66-4164-40b3-9577-0cc42cdca93a in product_1767756194758636000 (User: admin-user)
=== RUN   TestFormulaFields_Integration/Null_Value_Handling
2026/01/07 11:23:15 ‚ú® Created record c479c9de-bb25-4e3c-b1d3-95d2d40759d1 in product_1767756194758636000 (User: admin-user)
2026/01/07 11:23:15 ‚ö†Ô∏è Formula evaluation error on field 'total': invalid operation: <nil> * float64 (1:7)
 | price * quantity
 | ......^
    formula_integration_test.go:255: Total with null price: <nil> (type <nil>) - Expected nil
--- PASS: TestFormulaFields_Integration (0.37s)
    --- PASS: TestFormulaFields_Integration/Read-Time_Calculation (0.00s)
    --- PASS: TestFormulaFields_Integration/Filter_by_Formula_(Match) (0.00s)
    --- PASS: TestFormulaFields_Integration/Filter_by_Formula_(No_Match) (0.00s)
    --- PASS: TestFormulaFields_Integration/Verify_Generated_Column_Schema (0.00s)
    --- PASS: TestFormulaFields_Integration/Update_Propagation (0.00s)
    --- PASS: TestFormulaFields_Integration/Null_Value_Handling (0.00s)
=== RUN   TestFormulaValidation
2026/01/07 11:23:15 üìê Creating table: formula_validation_1767756195131952000
2026/01/07 11:23:15 üìù Executing DDL for formula_validation_1767756195131952000
2026/01/07 11:23:15 ‚úÖ DDL executed successfully for formula_validation_1767756195131952000
2026/01/07 11:23:15    ‚úÖ Table created and registered (strict): formula_validation_1767756195131952000
2026/01/07 11:23:15 ‚úÖ Auto-created default layout for formula_validation_1767756195131952000
2026/01/07 11:23:15 üóëÔ∏è Metadata cache invalidated
2026/01/07 11:23:15 ‚ûï Adding column amount to table formula_validation_1767756195131952000
2026/01/07 11:23:15    üèÅ Executing DDL: ALTER TABLE `formula_validation_1767756195131952000` ADD COLUMN `amount` VARCHAR(255)
2026/01/07 11:23:15    ‚úÖ DDL execution complete
2026/01/07 11:23:15    ‚úÖ Column added/registered: formula_validation_1767756195131952000.amount
2026/01/07 11:23:15 üóëÔ∏è Metadata cache invalidated
=== RUN   TestFormulaValidation/Valid_Formula_Syntax
2026/01/07 11:23:15 ‚ûï Adding column tax_amount to table formula_validation_1767756195131952000
2026/01/07 11:23:15    üèÅ Executing DDL: ALTER TABLE `formula_validation_1767756195131952000` ADD COLUMN `tax_amount` DECIMAL(18,6) GENERATED ALWAYS AS (amount * 1.1) VIRTUAL
2026/01/07 11:23:15    ‚úÖ DDL execution complete
2026/01/07 11:23:15    ‚úÖ Column added/registered: formula_validation_1767756195131952000.tax_amount
2026/01/07 11:23:15 üóëÔ∏è Metadata cache invalidated
    formula_integration_test.go:309: ‚úÖ Valid formula syntax accepted
=== RUN   TestFormulaValidation/Invalid_Formula_Syntax_-_Parse_Error
    formula_integration_test.go:327: ‚úÖ Invalid formula correctly rejected: validation error on field 'formula': Invalid formula syntax: unexpected token Operator("*") (1:10)
         | amount * * 1.1
         | .........^
=== RUN   TestFormulaValidation/Empty_Formula_Expression
    formula_integration_test.go:345: ‚úÖ Empty formula correctly rejected: validation error on field 'formula': Formula fields require a formula expression
=== RUN   TestFormulaValidation/Nil_Formula_Expression
    formula_integration_test.go:362: ‚úÖ Nil formula correctly rejected: validation error on field 'formula': Formula fields require a formula expression
--- PASS: TestFormulaValidation (0.21s)
    --- PASS: TestFormulaValidation/Valid_Formula_Syntax (0.08s)
    --- PASS: TestFormulaValidation/Invalid_Formula_Syntax_-_Parse_Error (0.00s)
    --- PASS: TestFormulaValidation/Empty_Formula_Expression (0.00s)
    --- PASS: TestFormulaValidation/Nil_Formula_Expression (0.00s)
=== RUN   TestFormulaFilter_ToSQL
=== RUN   TestFormulaFilter_ToSQL/Simple_equality
    query_filter_test.go:115: ‚úÖ Filter 'status == 'Open'' -> SQL '(status = ?)' with 1 args
=== RUN   TestFormulaFilter_ToSQL/Greater_than
    query_filter_test.go:115: ‚úÖ Filter 'amount > 1000' -> SQL '(amount > ?)' with 1 args
=== RUN   TestFormulaFilter_ToSQL/Less_than_or_equal
    query_filter_test.go:115: ‚úÖ Filter 'price <= 50.5' -> SQL '(price <= ?)' with 1 args
=== RUN   TestFormulaFilter_ToSQL/Not_equal
    query_filter_test.go:115: ‚úÖ Filter 'type != 'Cancelled'' -> SQL '(type != ?)' with 1 args
=== RUN   TestFormulaFilter_ToSQL/AND_condition
    query_filter_test.go:115: ‚úÖ Filter 'status == 'Open' && amount > 500' -> SQL '((status = ?) AND (amount > ?))' with 2 args
=== RUN   TestFormulaFilter_ToSQL/OR_condition
    query_filter_test.go:115: ‚úÖ Filter 'type == 'A' || type == 'B'' -> SQL '((type = ?) OR (type = ?))' with 2 args
=== RUN   TestFormulaFilter_ToSQL/CONTAINS_function
    query_filter_test.go:115: ‚úÖ Filter 'CONTAINS(name, 'Acme')' -> SQL 'name LIKE ?' with 1 args
=== RUN   TestFormulaFilter_ToSQL/STARTS_WITH_function
    query_filter_test.go:115: ‚úÖ Filter 'STARTS_WITH(name, 'Test')' -> SQL 'name LIKE ?' with 1 args
=== RUN   TestFormulaFilter_ToSQL/ENDS_WITH_function
    query_filter_test.go:115: ‚úÖ Filter 'ENDS_WITH(email, '.com')' -> SQL 'email LIKE ?' with 1 args
=== RUN   TestFormulaFilter_ToSQL/Empty_filter
    query_filter_test.go:88: ‚úÖ Empty filter handled correctly
=== RUN   TestFormulaFilter_ToSQL/Invalid_syntax
    query_filter_test.go:98: ‚úÖ Invalid syntax correctly rejected: failed to parse expression: unexpected token Operator("==") (1:11)
         | status == == 'Open'
         | ..........^
--- PASS: TestFormulaFilter_ToSQL (0.00s)
    --- PASS: TestFormulaFilter_ToSQL/Simple_equality (0.00s)
    --- PASS: TestFormulaFilter_ToSQL/Greater_than (0.00s)
    --- PASS: TestFormulaFilter_ToSQL/Less_than_or_equal (0.00s)
    --- PASS: TestFormulaFilter_ToSQL/Not_equal (0.00s)
    --- PASS: TestFormulaFilter_ToSQL/AND_condition (0.00s)
    --- PASS: TestFormulaFilter_ToSQL/OR_condition (0.00s)
    --- PASS: TestFormulaFilter_ToSQL/CONTAINS_function (0.00s)
    --- PASS: TestFormulaFilter_ToSQL/STARTS_WITH_function (0.00s)
    --- PASS: TestFormulaFilter_ToSQL/ENDS_WITH_function (0.00s)
    --- PASS: TestFormulaFilter_ToSQL/Empty_filter (0.00s)
    --- PASS: TestFormulaFilter_ToSQL/Invalid_syntax (0.00s)
=== RUN   TestFormulaFilter_StringFunctions
=== RUN   TestFormulaFilter_StringFunctions/CONTAINS_pattern
    query_filter_test.go:137: ‚úÖ CONTAINS produces correct LIKE pattern: SQL='name LIKE ?', pattern='%Acme%'
=== RUN   TestFormulaFilter_StringFunctions/STARTS_WITH_pattern
    query_filter_test.go:156: ‚úÖ STARTS_WITH produces correct LIKE pattern: SQL='name LIKE ?', pattern='Test%'
=== RUN   TestFormulaFilter_StringFunctions/ENDS_WITH_pattern
    query_filter_test.go:175: ‚úÖ ENDS_WITH produces correct LIKE pattern: SQL='email LIKE ?', pattern='%.com'
--- PASS: TestFormulaFilter_StringFunctions (0.00s)
    --- PASS: TestFormulaFilter_StringFunctions/CONTAINS_pattern (0.00s)
    --- PASS: TestFormulaFilter_StringFunctions/STARTS_WITH_pattern (0.00s)
    --- PASS: TestFormulaFilter_StringFunctions/ENDS_WITH_pattern (0.00s)
=== RUN   TestRoleHierarchy_ManagerVisibility
=== RUN   TestRoleHierarchy_ManagerVisibility/Rep_can_access_own_record
=== RUN   TestRoleHierarchy_ManagerVisibility/Manager_can_read_subordinate_record
=== RUN   TestRoleHierarchy_ManagerVisibility/VP_can_read_subordinate_record_(2_levels_down)
=== RUN   TestRoleHierarchy_ManagerVisibility/CEO_can_read_any_subordinate_record
=== RUN   TestRoleHierarchy_ManagerVisibility/Rep_cannot_read_Manager_record
=== RUN   TestRoleHierarchy_ManagerVisibility/Sibling_cannot_read_peer_record
=== RUN   TestRoleHierarchy_ManagerVisibility/Manager_cannot_edit_subordinate_record_via_hierarchy
=== NAME  TestRoleHierarchy_ManagerVisibility
    role_hierarchy_test.go:199: ‚úÖ Role Hierarchy tests completed successfully
--- PASS: TestRoleHierarchy_ManagerVisibility (0.02s)
    --- PASS: TestRoleHierarchy_ManagerVisibility/Rep_can_access_own_record (0.00s)
    --- PASS: TestRoleHierarchy_ManagerVisibility/Manager_can_read_subordinate_record (0.00s)
    --- PASS: TestRoleHierarchy_ManagerVisibility/VP_can_read_subordinate_record_(2_levels_down) (0.00s)
    --- PASS: TestRoleHierarchy_ManagerVisibility/CEO_can_read_any_subordinate_record (0.00s)
    --- PASS: TestRoleHierarchy_ManagerVisibility/Rep_cannot_read_Manager_record (0.00s)
    --- PASS: TestRoleHierarchy_ManagerVisibility/Sibling_cannot_read_peer_record (0.00s)
    --- PASS: TestRoleHierarchy_ManagerVisibility/Manager_cannot_edit_subordinate_record_via_hierarchy (0.00s)
=== RUN   TestSharingRules_Integration
=== RUN   TestSharingRules_Integration/Sales_user_can_read_Tech_record_via_sharing_rule
=== RUN   TestSharingRules_Integration/Sales_user_cannot_read_Finance_record_(criteria_mismatch)
=== RUN   TestSharingRules_Integration/Marketing_user_cannot_read_Tech_record_(not_in_shared_role)
=== RUN   TestSharingRules_Integration/Sales_user_cannot_edit_Tech_record_(rule_is_Read_only)
=== RUN   TestSharingRules_Integration/Marketing_user_can_edit_any_Account_record_(Edit_access,_no_criteria)
=== NAME  TestSharingRules_Integration
    sharing_rules_test.go:171: ‚úÖ Sharing Rules tests completed successfully
--- PASS: TestSharingRules_Integration (0.02s)
    --- PASS: TestSharingRules_Integration/Sales_user_can_read_Tech_record_via_sharing_rule (0.00s)
    --- PASS: TestSharingRules_Integration/Sales_user_cannot_read_Finance_record_(criteria_mismatch) (0.00s)
    --- PASS: TestSharingRules_Integration/Marketing_user_cannot_read_Tech_record_(not_in_shared_role) (0.00s)
    --- PASS: TestSharingRules_Integration/Sales_user_cannot_edit_Tech_record_(rule_is_Read_only) (0.00s)
    --- PASS: TestSharingRules_Integration/Marketing_user_can_edit_any_Account_record_(Edit_access,_no_criteria) (0.00s)
=== RUN   TestValidationRule_DateComparison
    validation_date_test.go:49: Got expected past date error: validation error: Close Date cannot be in the past
--- PASS: TestValidationRule_DateComparison (0.00s)
=== RUN   TestValidationRule_MissingField
    validation_repro_test.go:52: Validation error (as expected?): validation error: Close Date required
--- PASS: TestValidationRule_MissingField (0.00s)
=== RUN   TestValidationRule_Malformed
    validation_repro_test.go:85: Got expected system error: internal error: Validation rule '' failed to evaluate (caused by: unknown name NON_EXISTENT_FUNC (1:1)
         | NON_EXISTENT_FUNC() == true
         | ^)
--- PASS: TestValidationRule_Malformed (0.00s)
=== RUN   TestValidationRule_EmptyStringSyntax
=== RUN   TestValidationRule_EmptyStringSyntax/Empty_String_Check_(==_"")
=== RUN   TestValidationRule_EmptyStringSyntax/Nil_Check_(==_nil)_with_String
=== RUN   TestValidationRule_EmptyStringSyntax/Nil_Check_(==_nil)_with_Nil
=== RUN   TestValidationRule_EmptyStringSyntax/Combined_Check
=== RUN   TestValidationRule_EmptyStringSyntax/Len_Check
--- PASS: TestValidationRule_EmptyStringSyntax (0.00s)
    --- PASS: TestValidationRule_EmptyStringSyntax/Empty_String_Check_(==_"") (0.00s)
    --- PASS: TestValidationRule_EmptyStringSyntax/Nil_Check_(==_nil)_with_String (0.00s)
    --- PASS: TestValidationRule_EmptyStringSyntax/Nil_Check_(==_nil)_with_Nil (0.00s)
    --- PASS: TestValidationRule_EmptyStringSyntax/Combined_Check (0.00s)
    --- PASS: TestValidationRule_EmptyStringSyntax/Len_Check (0.00s)
FAIL
FAIL	github.com/nexuscrm/backend/internal/application/services	1.258s
FAIL
